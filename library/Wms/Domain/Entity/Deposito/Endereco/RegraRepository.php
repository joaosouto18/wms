<?php
namespace Wms\Domain\Entity\Deposito\Endereco;

use Doctrine\ORM\EntityRepository,
    Wms\Domain\Entity\Deposito\Endereco\Regra as RegraEntity;

/**
 * Regra
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */

class RegraRepository extends EntityRepository
{
    public function save(RegraEntity $regraEntity, array $values)
    {
	extract($values['identificacao']);
	$regraEntity->setDescricao($descricao);
	$this->getEntityManager()->persist($regraEntity);
    }

    public function remove($id)
    {
	$em = $this->getEntityManager();
	$proxy = $em->getReference('wms:Deposito\Endereco\Regra', $id);
	$count  = $proxy->getCaracteristicas()->count();
	if ($count > 0)
	    throw new \Exception("Não é possivel remover a Regra 
				    {$proxy->getDescricao()}, há {$count} 
				    caracteristica(s) vinculada(s).");
	$em->remove($proxy);
    }
    

}
